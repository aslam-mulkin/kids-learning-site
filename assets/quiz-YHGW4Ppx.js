import{r as c,j as e}from"./react-Bp1P4SmH.js";import{C as g,a as N,b as S,B as u}from"./flashcards-TtWmLsOp.js";const M="belajar-seru-progress-v1";function U(s){if(!s)return{};try{const n=JSON.parse(s);if(n&&typeof n=="object")return n}catch(n){console.warn("progress parse failed",n)}return{}}function E(){return typeof window>"u"?{}:U(localStorage.getItem(M))}function q(s){typeof window>"u"||localStorage.setItem(M,JSON.stringify(s))}function J(s,n){return`quiz:${s}:${n}`}function L(s,n){return!s||!n?null:E()[J(s,n)]??null}function T(s,n,i,o){if(!s||!n)return null;const a=E(),d=J(s,n),t=a[d],x={total:o,lastScore:i,bestScore:Math.max((t==null?void 0:t.bestScore)??0,i),attempts:((t==null?void 0:t.attempts)??0)+1,completed:i===o,lastPlayed:new Date().toISOString()};return a[d]=x,q(a),x}function V({items:s,topicKey:n,setId:i,onProgress:o}){const[a,d]=c.useState(0),[t,x]=c.useState(Array(s.length).fill(-1)),[f,w]=c.useState(!1),[C,h]=c.useState(!1),m=c.useRef(!1);c.useEffect(()=>{d(0),x(Array(s.length).fill(-1)),w(!1),h(!1),m.current=!1},[s]);const v=c.useMemo(()=>t.every(r=>r!==-1),[t]),j=c.useMemo(()=>t.reduce((r,l,b)=>r+(l===s[b].answer?1:0),0),[t,s]);c.useEffect(()=>{f&&!m.current&&(T(n,i,j,s.length),m.current=!0,o==null||o()),f||(m.current=!1)},[f,j,n,i,s.length,o]);function O(r){if(f)return;const l=[...t];l[a]=r,x(l)}function Q(){a<s.length-1&&d(a+1)}function $(){a>0&&d(a-1)}function R(){v&&w(!0)}function A(){d(0),x(Array(s.length).fill(-1)),w(!1),h(!1)}if(f&&!C)return e.jsxs(g,{className:"max-w-xl mx-auto",children:[e.jsx(N,{children:"Nilai Akhir"}),e.jsxs(S,{className:"space-y-3",children:[e.jsxs("div",{className:"text-lg font-semibold",children:["Skor: ",j," / ",s.length]}),e.jsx("div",{className:"text-sm text-slate-600",children:"Selesaikan semua soal untuk melihat kunci jawaban."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{onClick:()=>h(!0),children:"Lihat Kunci Jawaban"}),e.jsx(u,{variant:"outline",onClick:A,children:"Ulangi"})]})]})]});if(f&&C)return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(g,{className:"max-w-xl mx-auto",children:[e.jsx(N,{children:"Ulasan Jawaban"}),e.jsxs(S,{className:"text-sm text-slate-600",children:["Skor: ",j," / ",s.length]})]}),e.jsx("div",{className:"space-y-4",children:s.map((r,l)=>{const b=t[l];return e.jsxs(g,{className:"max-w-3xl mx-auto",children:[e.jsxs(N,{className:"mb-2",children:["Soal ",l+1]}),e.jsxs(S,{children:[e.jsx("div",{className:"mb-3",children:r.q}),e.jsx("div",{className:"space-y-2",children:r.options.map((k,p)=>{const B=p===r.answer?"border-green-500 bg-green-50":p===b?"border-red-500 bg-red-50":"border-slate-200";return e.jsxs("div",{className:`border rounded-xl p-2 ${B}`,children:[z(p),". ",k]},p)})}),r.explain&&e.jsxs("div",{className:"mt-3 text-sm text-slate-600",children:["Pembahasan: ",r.explain]})]})]},r.id)})}),e.jsxs("div",{className:"max-w-3xl mx-auto flex gap-2",children:[e.jsx(u,{variant:"outline",onClick:()=>h(!1),children:"Kembali"}),e.jsx(u,{onClick:A,children:"Ulangi Kuis"})]})]});const y=s[a],_=t[a];return e.jsxs(g,{className:"max-w-2xl mx-auto",children:[e.jsxs(N,{className:"mb-2",children:["Soal ",a+1," / ",s.length]}),e.jsxs(S,{children:[e.jsx("div",{className:"mb-4",children:y.q}),e.jsx("div",{className:"space-y-2 mb-4",children:y.options.map((r,l)=>{const k=_===l?"border-blue-500 ring-1 ring-blue-200":"border-slate-200";return e.jsxs("div",{className:`border rounded-xl p-2 cursor-pointer ${k}`,onClick:()=>O(l),children:[z(l),". ",r]},l)})}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(u,{variant:"outline",onClick:$,disabled:a===0,children:"Sebelumnya"}),e.jsx(u,{onClick:Q,disabled:a===s.length-1,children:"Berikutnya"}),e.jsx(u,{variant:"outline",onClick:R,className:"ml-auto",disabled:!v,children:"Selesai"})]}),!v&&e.jsx("div",{className:"mt-3 text-xs text-slate-500",children:"Jawab semua pertanyaan untuk menyelesaikan kuis."})]})]},y.id)}function z(s){return String.fromCharCode(65+s)}const Y=Object.freeze(Object.defineProperty({__proto__:null,default:V},Symbol.toStringTag,{value:"Module"}));export{Y as Q,L as g};
