import{r as c,j as e}from"./react-Bp1P4SmH.js";import{C as b,a as p,b as g,B as d}from"./flashcards-B-dRJlEX.js";const M="belajar-seru-progress-v1";function U(s){if(!s)return{};try{const n=JSON.parse(s);if(n&&typeof n=="object")return n}catch(n){console.warn("progress parse failed",n)}return{}}function J(){return typeof window>"u"?{}:U(localStorage.getItem(M))}function q(s){typeof window>"u"||localStorage.setItem(M,JSON.stringify(s))}function O(s,n){return`quiz:${s}:${n}`}function L(s,n){return!s||!n?null:J()[O(s,n)]??null}function T(s,n,i,o){if(!s||!n)return null;const a=J(),u=O(s,n),t=a[u],m={total:o,lastScore:i,bestScore:Math.max((t==null?void 0:t.bestScore)??0,i),attempts:((t==null?void 0:t.attempts)??0)+1,completed:i===o,lastPlayed:new Date().toISOString()};return a[u]=m,q(a),m}function V({items:s,topicKey:n,setId:i,onProgress:o}){const[a,u]=c.useState(0),[t,m]=c.useState(Array(s.length).fill(-1)),[x,k]=c.useState(!1),[y,N]=c.useState(!1),S=c.useRef(!1),w=c.useMemo(()=>t.every(r=>r!==-1),[t]),f=c.useMemo(()=>t.reduce((r,l,h)=>r+(l===s[h].answer?1:0),0),[t,s]);c.useEffect(()=>{x&&!S.current&&(T(n,i,f,s.length),S.current=!0,o==null||o()),x||(S.current=!1)},[x,f,n,i,s.length,o]);function Q(r){if(x)return;const l=[...t];l[a]=r,m(l)}function $(){a<s.length-1&&u(a+1)}function E(){a>0&&u(a-1)}function R(){w&&k(!0)}function C(){u(0),m(Array(s.length).fill(-1)),k(!1),N(!1)}if(x&&!y)return e.jsxs(b,{className:"max-w-xl mx-auto",children:[e.jsx(p,{children:"Nilai Akhir"}),e.jsxs(g,{className:"space-y-3",children:[e.jsxs("div",{className:"text-lg font-semibold",children:["Skor: ",f," / ",s.length]}),e.jsx("div",{className:"text-sm text-slate-600",children:"Selesaikan semua soal untuk melihat kunci jawaban."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{onClick:()=>N(!0),children:"Lihat Kunci Jawaban"}),e.jsx(d,{variant:"outline",onClick:C,children:"Ulangi"})]})]})]});if(x&&y)return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(b,{className:"max-w-xl mx-auto",children:[e.jsx(p,{children:"Ulasan Jawaban"}),e.jsxs(g,{className:"text-sm text-slate-600",children:["Skor: ",f," / ",s.length]})]}),e.jsx("div",{className:"space-y-4",children:s.map((r,l)=>{const h=t[l];return e.jsxs(b,{className:"max-w-3xl mx-auto",children:[e.jsxs(p,{className:"mb-2",children:["Soal ",l+1]}),e.jsxs(g,{children:[e.jsx("div",{className:"mb-3",children:r.q}),e.jsx("div",{className:"space-y-2",children:r.options.map((v,j)=>{const B=j===r.answer?"border-green-500 bg-green-50":j===h?"border-red-500 bg-red-50":"border-slate-200";return e.jsxs("div",{className:`border rounded-xl p-2 ${B}`,children:[A(j),". ",v]},j)})}),r.explain&&e.jsxs("div",{className:"mt-3 text-sm text-slate-600",children:["Pembahasan: ",r.explain]})]})]},r.id)})}),e.jsxs("div",{className:"max-w-3xl mx-auto flex gap-2",children:[e.jsx(d,{variant:"outline",onClick:()=>N(!1),children:"Kembali"}),e.jsx(d,{onClick:C,children:"Ulangi Kuis"})]})]});const z=s[a],_=t[a];return e.jsxs(b,{className:"max-w-2xl mx-auto",children:[e.jsxs(p,{className:"mb-2",children:["Soal ",a+1," / ",s.length]}),e.jsxs(g,{children:[e.jsx("div",{className:"mb-4",children:z.q}),e.jsx("div",{className:"space-y-2 mb-4",children:z.options.map((r,l)=>{const v=_===l?"border-blue-500 ring-1 ring-blue-200":"border-slate-200";return e.jsxs("div",{className:`border rounded-xl p-2 cursor-pointer ${v}`,onClick:()=>Q(l),children:[A(l),". ",r]},l)})}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(d,{variant:"outline",onClick:E,disabled:a===0,children:"Sebelumnya"}),e.jsx(d,{onClick:$,disabled:a===s.length-1,children:"Berikutnya"}),e.jsx(d,{variant:"outline",onClick:R,className:"ml-auto",disabled:!w,children:"Selesai"})]}),!w&&e.jsx("div",{className:"mt-3 text-xs text-slate-500",children:"Jawab semua pertanyaan untuk menyelesaikan kuis."})]})]})}function A(s){return String.fromCharCode(65+s)}const Y=Object.freeze(Object.defineProperty({__proto__:null,default:V},Symbol.toStringTag,{value:"Module"}));export{Y as Q,L as g};
